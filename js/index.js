function CGfxButton(e,t,a){var i,r,n,o,s=[];return this._init=function(e,t,a){i=1,r=new Array,n=new Array,o=createBitmap(a),o.x=e,o.y=t,o.regX=a.width/2,o.regY=a.height/2,s_oStage.addChild(o),this._initListener()},this.unload=function(){o.off("mousedown",this.buttonDown),o.off("pressup",this.buttonRelease),s_oStage.removeChild(o)},this.setVisible=function(e){o.visible=e},this._initListener=function(){o.on("mousedown",this.buttonDown),o.on("pressup",this.buttonRelease)},this.addEventListener=function(e,t,a){r[e]=t,n[e]=a},this.addEventListenerWithParams=function(e,t,a,i){r[e]=t,n[e]=a,s=i},this.buttonRelease=function(){o.scaleX=i,o.scaleY=i,r[ON_MOUSE_UP]&&r[ON_MOUSE_UP].call(n[ON_MOUSE_UP],s)},this.buttonDown=function(){o.scaleX=.9*i,o.scaleY=.9*i,r[ON_MOUSE_DOWN]&&r[ON_MOUSE_DOWN].call(n[ON_MOUSE_DOWN],s)},this.setScale=function(e){i=e,o.scaleX=e,o.scaleY=e},this.setPosition=function(e,t){o.x=e,o.y=t},this.setX=function(e){o.x=e},this.setY=function(e){o.y=e},this.getButtonImage=function(){return o},this.getX=function(){return o.x},this.getY=function(){return o.y},this._init(e,t,a),this}function CMain(e){var t,a,i=0,r=0;this.initContainer=function(){s_oCanvas=document.getElementById("canvas"),s_oStage=new createjs.Stage(s_oCanvas),createjs.Touch.enable(s_oStage),s_iPrevTime=(new Date).getTime();var e=new createjs.Text(COPY_TEXT,"12px 微软雅黑","#ffffff");e.textAlign="center",e.textBaseline="alphabetic",e.y=CANVAS_HEIGHT-50,e.x=CANVAS_WIDTH/2,s_oStage.addChild(e),s_oStage.setChildIndex(e,200),s_oSpriteLibrary=new CSpriteLibrary,a=new CPreloader,CURRENT_PAGE=a,createjs.Ticker.addEventListener("tick",this._update),createjs.Ticker.setFPS(21)},this.preloaderReady=function(){this._initSounds(),this._loadImages(),t=!0},this._initSounds=function(){createjs.Sound.initializeDefaultPlugins()&&(createjs.Sound.alternateExtensions=["ogg"],createjs.Sound.addEventListener("fileload",createjs.proxy(this.soundLoaded,this)),createjs.Sound.registerSound("./sounds/p4-mp3.mp3","p4"),r+=1)},this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this),s_oSpriteLibrary.addSprite("px","./sprites/p-x.png"),s_oSpriteLibrary.addSprite("p1denglong","./sprites/p1-denglong.png"),s_oSpriteLibrary.addSprite("p1ren1","./sprites/p1-ren1.png"),s_oSpriteLibrary.addSprite("p1bg","./sprites/p1-bg.jpg"),s_oSpriteLibrary.addSprite("p1ren2","./sprites/p1-ren2.png"),s_oSpriteLibrary.addSprite("p1ren3","./sprites/p1-ren3.png"),s_oSpriteLibrary.addSprite("p1ren12","./sprites/p1-ren1-2.png"),s_oSpriteLibrary.addSprite("p1ren22","./sprites/p1-ren2-2.png"),s_oSpriteLibrary.addSprite("p1ren32","./sprites/p1-ren3-2.png"),s_oSpriteLibrary.addSprite("p1text","./sprites/p1-text.png"),s_oSpriteLibrary.addSprite("p1text2","./sprites/p1-text2.png"),s_oSpriteLibrary.addSprite("p1zhuozi","./sprites/p1-zhuozi.png"),s_oSpriteLibrary.addSprite("p1bandeng","./sprites/p1-bandeng.png"),s_oSpriteLibrary.addSprite("p2bg","./sprites/p2-bg.jpg"),s_oSpriteLibrary.addSprite("p2bg2","./sprites/p2-bg2.jpg"),s_oSpriteLibrary.addSprite("p2ma","./sprites/p2-ma.png"),s_oSpriteLibrary.addSprite("p2ma2","./sprites/p2-ma2.png"),s_oSpriteLibrary.addSprite("p2wang","./sprites/p2-wang.png"),s_oSpriteLibrary.addSprite("p2text","./sprites/p2-text.png"),s_oSpriteLibrary.addSprite("p2text2","./sprites/p2-text2.png"),s_oSpriteLibrary.addSprite("p3ba","./sprites/p3-ba.png"),s_oSpriteLibrary.addSprite("p3bg1","./sprites/p3-bg-1.jpg"),s_oSpriteLibrary.addSprite("p3bg2","./sprites/p3-bg-2.png"),s_oSpriteLibrary.addSprite("p3bg3","./sprites/p3-bg-3.jpg"),s_oSpriteLibrary.addSprite("p3ma","./sprites/p3-ma.png"),s_oSpriteLibrary.addSprite("p3bama","./sprites/p3-bama.png"),s_oSpriteLibrary.addSprite("p3text2","./sprites/p3-text2.png"),s_oSpriteLibrary.addSprite("p3jiaozi","./sprites/p3-jiaozi.png"),s_oSpriteLibrary.addSprite("p3ji","./sprites/p3-ji.png"),s_oSpriteLibrary.addSprite("p3yu","./sprites/p3-yu.png"),s_oSpriteLibrary.addSprite("p3zhuozi","./sprites/p3-zhuozi.png"),s_oSpriteLibrary.addSprite("p4bg","./sprites/p4-bg.jpg"),s_oSpriteLibrary.addSprite("p4shan","./sprites/p4-shan.png"),s_oSpriteLibrary.addSprite("p4huoche","./sprites/p4-huoche.png"),s_oSpriteLibrary.addSprite("p4zui","./sprites/p4-zui.png"),s_oSpriteLibrary.addSprite("p5lunzi","./sprites/p5-lunzi.png"),s_oSpriteLibrary.addSprite("p5playdown","./sprites/p5-play-down.png"),s_oSpriteLibrary.addSprite("p5playup","./sprites/p5-play-up.png"),s_oSpriteLibrary.addSprite("p5player","./sprites/p5-player.png"),s_oSpriteLibrary.addSprite("p5recordup","./sprites/p5-record-up.png"),s_oSpriteLibrary.addSprite("p5recorddown","./sprites/p5-record-down.png"),s_oSpriteLibrary.addSprite("p5shareup","./sprites/p5-share-up.png"),s_oSpriteLibrary.addSprite("p5textbottom","./sprites/p5-text-bottom.png"),s_oSpriteLibrary.addSprite("p5texttop","./sprites/p5-text-top.png"),s_oSpriteLibrary.addSprite("p5sharetip","./sprites/p5-sharetip.png"),s_oSpriteLibrary.addSprite("yanhua","./sprites/yanhua.png"),r+=s_oSpriteLibrary.getNumSprites(),s_oSpriteLibrary.loadSprites()},this._onImagesLoaded=function(){i++;var e=Math.floor(i/r*100);a.refreshLoader(e),i===r&&setTimeout(function(){s_oMain._gotoPage1()},100)},this.soundLoaded=function(){i++;var e=Math.floor(i/r*100);a.refreshLoader(e),i===r&&setTimeout(function(){s_oMain._gotoPage1()},100)},this._gotoPage1=function(){a.unload(function(){s_oStage.removeAllChildren();var e=createBitmap(s_oSpriteLibrary.getSprite("p3bg1"));s_oStage.addChild(e),CURRENT_PAGE=new CPage1})},this._onAllImagesLoaded=function(){},this.onAllPreloaderImagesLoaded=function(){this._loadImages()},this.stopUpdate=function(){t=!1},this.startUpdate=function(){t=!0},this._update=function(e){t!==!1&&(CURRENT_PAGE.update(),s_oStage.update(e))},s_oMain=this,this.initContainer()}function CPage1(){var e,t,a,i,r,n,o,s,c,p,d,l,h,g,u;this.init=function(){t=new createjs.Container,e=createBitmap(s_oSpriteLibrary.getSprite("p1bg")),i=createBitmap(s_oSpriteLibrary.getSprite("p1denglong")),r=createBitmap(s_oSpriteLibrary.getSprite("p1ren1")),n=createBitmap(s_oSpriteLibrary.getSprite("p1ren2")),o=createBitmap(s_oSpriteLibrary.getSprite("p1ren3")),d=createBitmap(s_oSpriteLibrary.getSprite("p1text")),g=createBitmap(s_oSpriteLibrary.getSprite("p1text2")),l=createBitmap(s_oSpriteLibrary.getSprite("p1zhuozi")),s=createBitmap(s_oSpriteLibrary.getSprite("p1ren12")),c=createBitmap(s_oSpriteLibrary.getSprite("p1ren22")),p=createBitmap(s_oSpriteLibrary.getSprite("p1ren32")),h=createBitmap(s_oSpriteLibrary.getSprite("p1bandeng")),e.y=-1500,t.addChild(e),i.x=60,i.y=-80,t.addChild(i),n.x=0,n.y=-345,c.x=-100,c.y=200,c.alpha=0,t.addChild(n),t.addChild(c),o.x=730,o.y=-800,p.x=650,p.y=600,o.rotation=10,p.alpha=0,p.rotation=10,p.regX=322,p.regY=491,o.regX=322,o.regY=491,t.addChild(o),t.addChild(p),l.x=(CANVAS_WIDTH-670)/2,l.y=-(CANVAS_HEIGHT-700),t.addChild(l),h.x=CANVAS_WIDTH,h.y=CANVAS_HEIGHT-250,t.addChild(h),r.y=-(CANVAS_HEIGHT-540),s.y=CANVAS_HEIGHT-780,t.addChild(r),d.x=591,d.y=413,d.regX=491,d.regY=363,d.scaleX=0,d.scaleY=0,g.x=591,g.y=413,g.regX=491,g.regY=363,t.addChild(d),a=createBitmap(s_oSpriteLibrary.getSprite("px"));var u=new createjs.Shadow("#ffffff",5,5,10);a.shadow=u,a.y=CANVAS_HEIGHT-160,a.x=CANVAS_WIDTH-100,a.regX=29.5,a.regY=28,t.addChild(a),s_oStage.addChild(t),this._animationInto()},this._animationInto=function(){createjs.Tween.get(e).to({x:0,y:0},500,createjs.Ease.backInOut).call(function(){}),createjs.Tween.get(i).to({x:60,y:80},1e3,createjs.Ease.backInOut).call(function(){createjs.Tween.get(i,{loop:!0}).to({rotation:5},1e3,createjs.Ease.linear).to({rotation:0},1e3,createjs.Ease.linear).call(function(){})}),createjs.Tween.get(r).to({y:CANVAS_HEIGHT-540},1e3,createjs.Ease.backInOut).call(function(){}),createjs.Tween.get(n).to({y:345},1500,createjs.Ease.backInOut).call(function(){}),createjs.Tween.get(o).to({y:850},2e3,createjs.Ease.backInOut).call(function(){createjs.Tween.get(d).to({scaleX:1,scaleY:1},1e3,createjs.Ease.backInOut).call(function(){createjs.Tween.get(d,{loop:!0}).to({x:589,y:415},100,createjs.Ease.backInOut).to({x:593,y:411},100,createjs.Ease.linear),createjs.Tween.get(r,{}).wait(1500).to({y:CANVAS_HEIGHT-780,scaleX:1.5,scaleY:1.5},1e3,createjs.Ease.backInOut).to({alpha:.5},1).call(function(){t.removeChild(r),t.addChild(s)}),createjs.Tween.get(n,{}).wait(1500).to({y:200,scaleX:1.5,scaleY:1.5},1e3,createjs.Ease.backInOut).to({alpha:.5},1).call(function(){t.removeChild(n),c.alpha=1}),createjs.Tween.get(o,{}).wait(1500).to({scaleX:1.5,scaleY:1.5},1e3,createjs.Ease.backInOut).call(function(){t.removeChild(o),p.alpha=1,t.removeChild(d),t.addChild(g),createjs.Tween.get(g,{loop:!0}).to({scaleX:1.1,scaleY:1.1},1e3,createjs.Ease.backInOut).to({scaleX:1,scaleY:1},500,createjs.Ease.linear).call(function(){}),createjs.Tween.get(a,{loop:!0}).to({scaleX:1.5,scaleY:1.5},1e3,createjs.Ease.bounceOut).to({scaleX:1,scaleY:1},1e3,createjs.Ease.bounceIn).call(function(){}),a.on("mousedown",u.goToNext)})})}),createjs.Tween.get(l).to({y:CANVAS_HEIGHT-700},1e3,createjs.Ease.backInOut).call(function(){}),createjs.Tween.get(h).to({x:CANVAS_WIDTH-200},1e3,createjs.Ease.backInOut).call(function(){})},this.unload=function(){createjs.Tween.get(t).to({y:-CANVAS_HEIGHT},500,createjs.Ease.linear).call(function(){t.removeAllChildren(),s_oStage.removeChild(t),new CPage2})},this.update=function(){},this.goToNext=function(){u.unload()},u=this,this.init()}function CPage2(){var e,t,a,i,r,n,o,s,c;this.init=function(){var p=createBitmap(s_oSpriteLibrary.getSprite("p3bg1"));s_oStage.addChild(p),e=createBitmap(s_oSpriteLibrary.getSprite("p2bg")),e.y=CANVAS_HEIGHT,s_oStage.addChild(e),i=createBitmap(s_oSpriteLibrary.getSprite("p2bg2")),i.x=CANVAS_WIDTH,s_oStage.addChild(i),t=createBitmap(s_oSpriteLibrary.getSprite("p2ma")),t.x=-300,t.y=CANVAS_HEIGHT-980,s_oStage.addChild(t),r=createBitmap(s_oSpriteLibrary.getSprite("p2wang")),r.x=400+CANVAS_WIDTH,r.y=800,r.alpha=0,s_oStage.addChild(r),a=createBitmap(s_oSpriteLibrary.getSprite("p2ma2")),a.x=CANVAS_WIDTH,a.y=CANVAS_HEIGHT-980+450,a.scaleX=.5,a.scaleY=.5,a.alpha=0,s_oStage.addChild(a),o=createBitmap(s_oSpriteLibrary.getSprite("p2text")),o.x=250,o.y=100,s=createBitmap(s_oSpriteLibrary.getSprite("p2text2")),s.x=200,s.y=493,s.regY=393;var d=new createjs.Shadow("#ffffff",5,5,10);c=createBitmap(s_oSpriteLibrary.getSprite("px")),c.shadow=d,c.y=CANVAS_HEIGHT-160,c.x=CANVAS_WIDTH-100,c.regX=29.5,c.regY=28,s_oStage.addChild(c),createjs.Tween.get(e).to({y:0},500,createjs.Ease.backInOut).call(function(){}),createjs.Tween.get(t).to({x:10,y:CANVAS_HEIGHT-980},2e3,createjs.Ease.backInOut).call(function(){s_oStage.addChild(o),createjs.Tween.get(o,{loop:!0}).to({x:252,y:102},300,createjs.Ease.backInOut).to({x:248,y:98},300,createjs.Ease.backInOut),createjs.Tween.get(e).wait(2e3).to({x:-CANVAS_WIDTH},1e3,createjs.Ease.backInOut).call(function(){s_oStage.removeChild(o)}),createjs.Tween.get(t).wait(1500).to({x:CANVAS_WIDTH,y:CANVAS_HEIGHT-980+450,scaleX:.5,scaleY:.5},2e3,createjs.Ease.backInOut).call(function(){s_oStage.removeChild(t)}),createjs.Tween.get(i).wait(2e3).to({x:0},1e3,createjs.Ease.backInOut).call(function(){s_oStage.removeChild(e),createjs.Tween.get(a).to({alpha:1,x:-30,y:CANVAS_HEIGHT-980,scaleX:.85,scaleY:.85},1e3,createjs.Ease.backInOut).call(function(){s_oStage.removeChild(e)}),createjs.Tween.get(r).to({alpha:1,x:400},100,createjs.Ease.backInOut).call(function(){s_oStage.addChild(s),createjs.Tween.get(s,{loop:!0}).to({scaleX:1.1,scaleY:1.1},800,createjs.Ease.bounceOut).to({scaleX:1,scaleY:1},500,createjs.Ease.linear),createjs.Tween.get(c).wait(2e3).to({y:900,x:350},1e3,createjs.Ease.backInOut).call(function(){c.on("mousedown",n.goToNext),createjs.Tween.get(c,{loop:!0}).to({scaleX:1.5,scaleY:1.5},1e3,createjs.Ease.linear).to({scaleX:1,scaleY:1},500,createjs.Ease.linear).call(function(){})})})})})},this.unload=function(){createjs.Tween.get(c).to({y:CANVAS_HEIGHT-160,x:CANVAS_WIDTH-100},1e3,createjs.Ease.backInOut).call(function(){s_oStage.removeAllChildren(),new CPage3})},this.update=function(){},this.goToNext=function(){n.unload()},n=this,this.init()}function CPage3(){var e,t,a,i,r,n,o,s,c,p,d,l,h,g,u;this.init=function(){l=new createjs.Container,e=createBitmap(s_oSpriteLibrary.getSprite("p3bg1")),e.y=-1400,l.addChild(e),i=createBitmap(s_oSpriteLibrary.getSprite("p3ma")),i.y=300,i.x=-350,l.addChild(i),r=createBitmap(s_oSpriteLibrary.getSprite("p3ba")),r.x=CANVAS_WIDTH-400+CANVAS_WIDTH,r.y=250,l.addChild(r),a=createBitmap(s_oSpriteLibrary.getSprite("p3zhuozi")),a.y=CANVAS_HEIGHT-656+CANVAS_HEIGHT,l.addChild(a),o=createBitmap(s_oSpriteLibrary.getSprite("p3yu")),o.y=CANVAS_HEIGHT-780+CANVAS_HEIGHT,o.x=150,l.addChild(o),s=createBitmap(s_oSpriteLibrary.getSprite("p3jiaozi")),s.y=CANVAS_HEIGHT-500+CANVAS_HEIGHT,s.x=350,l.addChild(s),n=createBitmap(s_oSpriteLibrary.getSprite("p3ji")),n.y=CANVAS_HEIGHT-500+CANVAS_HEIGHT,n.x=-50,l.addChild(n),t=createBitmap(s_oSpriteLibrary.getSprite("p3bg2")),t.alpha=0,t.scaleX=5,t.scaleY=5,t.x=CANVAS_WIDTH/2,t.y=CANVAS_HEIGHT/2,t.regX=CANVAS_WIDTH/2,t.regY=CANVAS_HEIGHT/2,l.addChild(t),c=createBitmap(s_oSpriteLibrary.getSprite("p1text")),c.x=120,c.y=60,l.addChild(c),createjs.Tween.get(e).to({x:0,y:0},500,createjs.Ease.backInOut).call(function(){createjs.Tween.get(c,{loop:!0}).to({x:122,y:62},300,createjs.Ease.backInOut).to({x:118,y:58},300,createjs.Ease.backInOut)}),createjs.Tween.get(i).to({x:50},1e3,createjs.Ease.backInOut).call(function(){}),createjs.Tween.get(r).to({x:CANVAS_WIDTH-400},1e3,createjs.Ease.backInOut).call(function(){}),createjs.Tween.get(a).to({y:CANVAS_HEIGHT-656},500,createjs.Ease.backInOut).call(function(){}),createjs.Tween.get(o).to({y:CANVAS_HEIGHT-780},1e3,createjs.Ease.backInOut).call(function(){}),createjs.Tween.get(s).to({y:CANVAS_HEIGHT-500},1500,createjs.Ease.backInOut).call(function(){}),createjs.Tween.get(n).to({y:CANVAS_HEIGHT-500},2e3,createjs.Ease.backInOut).call(function(){}),createjs.Tween.get(t).to({alpha:1,scaleX:1,scaleY:1},3e3,createjs.Ease.backInOut).call(function(){g.animate()}),h=new createjs.Container,p=createBitmap(s_oSpriteLibrary.getSprite("p3bg3")),h.addChild(p),d=createBitmap(s_oSpriteLibrary.getSprite("p3text2")),d.x=670,d.y=373,d.regX=620,d.regY=363,d.scaleX=.1,d.scaleY=.1,d.alpha=0,h.y=CANVAS_HEIGHT,h.regX=0,h.regY=CANVAS_HEIGHT,h.scaleX=3,h.scaleY=3,h.addChild(d),s_oStage.addChild(h),l.y=CANVAS_HEIGHT,l.regY=CANVAS_HEIGHT,s_oStage.addChild(l);var S=new createjs.Shadow("#ffffff",5,5,10);u=createBitmap(s_oSpriteLibrary.getSprite("px")),u.shadow=S,u.y=CANVAS_HEIGHT-160,u.x=CANVAS_WIDTH-100,u.regX=29.5,u.regY=28,s_oStage.addChild(u)},this.animate=function(){createjs.Tween.get(l).wait(1e3).to({scaleX:0,scaleY:0},1e3,createjs.Ease.linear).call(function(){s_oStage.removeChild(l),createjs.Tween.get(d).to({alpha:1,scaleY:.8,scaleX:.8},1e3,createjs.Ease.backInOut).call(function(){createjs.Tween.get(d,{loop:!0}).to({scaleY:1,scaleX:1},1e3,createjs.Ease.backInOut).to({scaleY:.8,scaleX:.8},500,createjs.Ease.linear)}),createjs.Tween.get(u).to({y:650,x:620},1e3,createjs.Ease.backInOut).call(function(){createjs.Tween.get(u,{loop:!0}).to({scaleX:1.2,scaleY:1.2},1e3,createjs.Ease.bounceOut).to({scaleX:1,scaleY:1},1e3,createjs.Ease.bounceIn).call(function(){}),u.on("mousedown",g.goToNext)})}),createjs.Tween.get(h).wait(1e3).to({scaleX:1,scaleY:1},1e3,createjs.Ease.linear).call(function(){})},this.unload=function(){createjs.Tween.get(u).to({y:CANVAS_HEIGHT-160,x:CANVAS_WIDTH-100},500,createjs.Ease.backInOut).call(function(){new CPage4,setTimeout(function(){s_oStage.removeChild(h),s_oStage.removeChild(u)},1e3)})},this.update=function(){},this.goToNext=function(){g.unload(),createjs.Sound.play("p4",{loop:-1})},g=this,this.init()}function CPage4(){var e,t,a,i,r,n,o,s,c,p,d,l,h,g,u,S,_=!1;this.init=function(){document.getElementById("music").pause(),$("#musicbtn").hide(),i=new createjs.Container,S=createBitmap(s_oSpriteLibrary.getSprite("p4bg")),i.addChild(S),createjs.Tween.get(S).to({alpha:1},2e3,createjs.Ease.backInOut).call(function(){});var _=new createjs.Graphics;_.beginFill(createjs.Graphics.getRGB(255,0,0)),_.drawCircle(0,0,3);var m=new createjs.Graphics;m.beginFill(createjs.Graphics.getRGB(255,255,255));var w=m.drawCircle(0,0,4).command;p=new createjs.Container,p.x=CANVAS_WIDTH/2,p.y=CANVAS_HEIGHT-200,p.alpha=0,p.addChild(new createjs.Shape(m)),p.addChild(new createjs.Shape(_)),i.addChild(p),d=new createjs.Text("",'bolder 40px "PingFang SC", "Lantinghei SC", "Helvetica Neue", Helvetica, Arial, "Microsoft YaHei", 微软雅黑, STHeitiSC-Light, simsun, 宋体, "WenQuanYi Zen Hei", "WenQuanYi Micro Hei", sans-serif',"#ff0000"),d.textBaseline="alphabetic",d.textAlign="center",d.width=750,d.scaleX=.1,d.scaleY=.1,i.addChild(d),createjs.Tween.get(w,{loop:!0}).to({radius:5},500,createjs.Ease.backInOut).to({radius:4},500,createjs.Ease.backInOut).call(function(){}),createjs.Tween.get(p).to({alpha:1},2e3,createjs.Ease.backInOut).call(function(){});var y=random(50,700),f=random(100,500);createjs.Tween.get(p).to({x:y,y:f},1500,createjs.Ease.backIn).call(function(){var e=getRandom(1,2.5);g.x=y,g.y=y,g.alpha=1,g.scaleX=e,g.scaleY=e,g.gotoAndPlay("run"),g.complete||g.addEventListener("animationend",function(){g.alpha=0}),p.x=CANVAS_WIDTH/2,p.y=CANVAS_HEIGHT-200}),s=setInterval(function(){var e=random(50,700),t=random(100,500);d.color="rgba("+parseInt(getRandom(100,255))+","+parseInt(getRandom(100,255))+","+parseInt(getRandom(100,255))+" , 0.7)",createjs.Tween.get(p).to({x:e,y:t},2e3,createjs.Ease.easeOut).call(function(){d.text=DM_TEXT[random(0,DM_TEXT.length-1)],d.x=e,d.y=t,createjs.Tween.get(d).to({alpha:1,scaleX:1,scaleY:1},500,createjs.Ease.easeOut).call(function(){createjs.Tween.get(d).wait(500).to({alpha:0,scaleX:.1,scaleY:.1},500,createjs.Ease.easeOut).call(function(){})}),p.x=CANVAS_WIDTH/2,p.y=CANVAS_HEIGHT-200})},2100);var b=new createjs.Graphics;b.beginFill(createjs.Graphics.getRGB(255,0,0)),b.drawCircle(0,0,3);var x=new createjs.Graphics;x.beginFill(createjs.Graphics.getRGB(255,255,255));var C=x.drawCircle(0,0,4).command;l=new createjs.Container,l.x=CANVAS_WIDTH/2,l.y=CANVAS_HEIGHT-200,l.addChild(new createjs.Shape(m)),l.addChild(new createjs.Shape(_)),i.addChild(l),h=new createjs.Text("",'40px "PingFang SC", "Lantinghei SC", "Helvetica Neue", Helvetica, Arial, "Microsoft YaHei", 微软雅黑, STHeitiSC-Light, simsun, 宋体, "WenQuanYi Zen Hei", "WenQuanYi Micro Hei", sans-serif',"#ff0000"),h.textBaseline="alphabetic",h.textAlign="center",h.width=750,h.scaleX=.1,h.scaleY=.1,i.addChild(h),createjs.Tween.get(C,{loop:!0}).to({radius:5},500,createjs.Ease.backInOut).to({radius:4},500,createjs.Ease.backInOut).call(function(){});var j=random(200,550),A=random(100,500);createjs.Tween.get(l).to({x:j,y:A},1500,createjs.Ease.backIn).call(function(){l.x=CANVAS_WIDTH/2,l.y=CANVAS_HEIGHT-200}),setInterval(function(){var e=random(200,550),t=random(100,500);h.color="rgba("+parseInt(getRandom(100,255))+","+parseInt(getRandom(100,255))+","+parseInt(getRandom(100,255))+" , 0.7)",createjs.Tween.get(l).wait(1e3).to({x:e,y:t},2e3,createjs.Ease.easeOut).call(function(){var a=getRandom(1,2.5);g.x=e,g.y=t,g.alpha=1,g.scaleX=a,g.scaleY=a,g.gotoAndPlay("run"),g.complete||g.addEventListener("animationend",function(){g.alpha=0}),l.x=CANVAS_WIDTH/2,l.y=CANVAS_HEIGHT-200})},3100),r=createBitmap(s_oSpriteLibrary.getSprite("p4shan")),c=createBitmap(s_oSpriteLibrary.getSprite("p4shan")),r.y=CANVAS_HEIGHT-485,r.x=0,c.x=0,c.y=CANVAS_HEIGHT-485,i.addChild(r),i.addChild(c),e=createBitmap(s_oSpriteLibrary.getSprite("p4huoche")),e.y=CANVAS_HEIGHT-230,e.x=180,i.addChild(e);var T={images:[s_oSpriteLibrary.getSprite("yanhua")],frames:{width:255,height:255,spacing:0},framerate:10,animations:{stand:15,run:[0,15]}},E=new createjs.SpriteSheet(T);g=new createjs.Sprite(E,"stand"),g.regX=127.5,g.regY=127.5,i.addChild(g);var I={images:[s_oSpriteLibrary.getSprite("p4zui")],frames:{width:92,height:92,spacing:0},framerate:4,animations:{stand:0,run:[0,1]}},v=new createjs.SpriteSheet(I);u=new createjs.Sprite(v,"run"),u.x=CANVAS_WIDTH-150,u.y=60,u.on("mousedown",this._play),i.addChild(u);var H=new createjs.Shadow("#ffffff",5,5,10);t=createBitmap(s_oSpriteLibrary.getSprite("px")),t.shadow=H,t.y=CANVAS_HEIGHT-160,t.x=CANVAS_WIDTH-100,t.regX=29.5,t.regY=28,i.addChild(t),i.x=CANVAS_WIDTH,s_oStage.addChild(i),createjs.Tween.get(i).to({x:0},1e3,createjs.Ease.linear).call(function(){r.x=-1500,n=createjs.Tween.get(r,{loop:!0}).to({x:0},3e3,createjs.Ease.linear).call(function(){}),o=createjs.Tween.get(c,{loop:!0}).to({x:1500},3e3,createjs.Ease.linear).call(function(){}),createjs.Tween.get(t).to({x:662,y:1080},500,createjs.Ease.backInOut).call(function(){t.on("mousedown",a.goToNext),createjs.Tween.get(t,{loop:!0}).to({scaleX:1.5,scaleY:1.5},1e3,createjs.Ease.bounceOut).to({scaleX:1,scaleY:1},1e3,createjs.Ease.bounceIn).call(function(){})})})},this._play=function(){_?(_=!1,u.gotoAndPlay("run"),createjs.Sound.play("p4",{loop:-1})):(_=!0,u.gotoAndPlay("stand"),createjs.Sound.stop("p4"))},this.unload=function(){createjs.Sound.stop("p4"),i.removeChild(t,u),clearInterval(s),createjs.Tween.get(e).to({x:-1640},2e3,createjs.Ease.linear).call(function(){n.pause(),o.pause(),i.removeChild(e)})},this.update=function(){},this.goToNext=function(){a.unload(),new CPage5},a=this,this.init()}function CPage5(){var e,t,a,i,r,n,o,s,c,p,d,l,h,g,u,S,_=0;this.init=function(){d=createBitmap(s_oSpriteLibrary.getSprite("p5texttop")),d.y=150,d.x=750,s_oStage.addChild(d),p=createBitmap(s_oSpriteLibrary.getSprite("p5textbottom")),p.y=950,p.x=750,s_oStage.addChild(p),c=createBitmap(s_oSpriteLibrary.getSprite("p5player")),c.x=(CANVAS_WIDTH-610)/2+700,c.y=400,s_oStage.addChild(c),e=createBitmap(s_oSpriteLibrary.getSprite("p5sharetip")),e.on("mousedown",function(){s_oStage.removeChild(e)}),S=new createjs.Text("","80px Arial","#ff7700"),S.x=380,S.y=630,S.lineWidth=100,S.textAlign="center",S.color="#f98803",S.textBaseline="alphabetic",s_oStage.addChild(S),createjs.Tween.get(d).to({x:0},1500,createjs.Ease.linear),createjs.Tween.get(p).to({x:0},1500,createjs.Ease.linear),createjs.Tween.get(c).to({x:(CANVAS_WIDTH-610)/2},1e3,createjs.Ease.linear).call(function(){a=new CGfxButton(197,800,s_oSpriteLibrary.getSprite("p5playdown")),a.getButtonImage().alpha=0,t=new CGfxButton(197,800,s_oSpriteLibrary.getSprite("p5playup")),t.addEventListener(ON_MOUSE_UP,u._tryPlay,u),i=new CGfxButton(552,800,s_oSpriteLibrary.getSprite("p5shareup")),i.addEventListener(ON_MOUSE_UP,u._up,u),s=new CGfxButton(375,800,s_oSpriteLibrary.getSprite("p5recorddown")),s.getButtonImage().alpha=0,o=new CGfxButton(375,800,s_oSpriteLibrary.getSprite("p5recordup")),o.addEventListener(ON_MOUSE_UP,u._recordStart,u),r=createBitmap(s_oSpriteLibrary.getSprite("p5lunzi")),r.x=278,r.regX=58,r.regY=58,r.y=608,s_oStage.addChild(r),n=createBitmap(s_oSpriteLibrary.getSprite("p5lunzi")),n.x=478,n.y=608,n.regX=58,n.regY=58,s_oStage.addChild(n)})},this.unload=function(){},this._up=function(){return 0==_?void showFail("请先录音才能制成"):void wx.uploadVoice({localId:_,isShowProgressTips:1,success:function(t){var a=t.serverId;$.get("http://www.wexue.top:25000/spring/upRecord",{openid:openid,mediaid:a},function(t){0==t.code&&(mid=a,wx.onMenuShareAppMessage({title:UN+"送给你的新年问候,快打开来听听吧",desc:"过年了,等你回家!",link:"http://www.wexue.top/games/cj/friends.php?fid="+openid+"&mid="+mid,imgUrl:"http://www.wexue.top/games/cj/sprites/page1.png",type:"link",dataUrl:"",success:function(){MtaH5.clickStat("msgshare")},cancel:function(){}})),s_oStage.addChild(e)})}})},this._tryStop=function(){g=3,l.pause(),h.pause(),t.addEventListener(ON_MOUSE_UP,this._tryPlay,this),a.getButtonImage().alpha=0,t.getButtonImage().alpha=1,wx.stopVoice({localId:_})},this._tryPlay=function(){return 0==_?void showFail("请先录音才能播放"):0==g?void showFail("请先结束录音才能播放"):(S.text="",g=2,l=createjs.Tween.get(r,{loop:!0}).to({rotation:360},1e3,createjs.Ease.linear),h=createjs.Tween.get(n,{loop:!0}).to({rotation:360},1e3,createjs.Ease.linear),t.addEventListener(ON_MOUSE_UP,this._tryStop,this),a.getButtonImage().alpha=1,t.getButtonImage().alpha=0,wx.playVoice({localId:_}),void wx.onVoicePlayEnd({success:function(){showFail("播放结束"),u._tryStop()}}))},this._recordStop=function(){g=1,l.pause(),h.pause(),o.addEventListener(ON_MOUSE_UP,this._recordStart,this),s.getButtonImage().alpha=0,o.getButtonImage().alpha=1,wx.stopRecord({success:function(e){_=e.localId}})},this._recordStart=function(){S.text=1,2==g&&this._tryStop(),g=0,l=createjs.Tween.get(r,{loop:!0}).to({rotation:360},1e3,createjs.Ease.linear).call(function(){S.text=S.text+1,59==S.text&&(u._recordStop(),S.text="")}),h=createjs.Tween.get(n,{loop:!0}).to({rotation:360},1e3,createjs.Ease.linear),o.addEventListener(ON_MOUSE_UP,this._recordStop,this),s.getButtonImage().alpha=1,o.getButtonImage().alpha=0,wx.startRecord({fail:function(){showFail("微信好像不能录音,您是不是没有打开录音权限呢")}}),wx.onVoiceRecordEnd({fail:function(){showFail("微信好像不能录音,您是不是没有打开录音权限呢")},complete:function(e){_=e.localId,showFail("超过60秒,录音结束"),u._recordStop()}})},this.update=function(){},u=this,this.init()}function CPreloader(){var e,t,a,i,r,n,o,s,c;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this),s_oSpriteLibrary.addSprite("logo","./sprites/logo.png"),s_oSpriteLibrary.addSprite("bg","./sprites/p3-bg-1.jpg"),s_oSpriteLibrary.addSprite("xin1","./sprites/p-xin1.png"),s_oSpriteLibrary.addSprite("xin2","./sprites/p-xin2.png"),s_oSpriteLibrary.addSprite("x","./sprites/p-x.png"),s_oSpriteLibrary.addSprite("photo","./sprites/p-photo.jpg"),s_oSpriteLibrary.addSprite("text","./sprites/p-text.png"),s_oSpriteLibrary.loadSprites()},this.unload=function(t){createjs.Tween.get(i).to({y:200},500,createjs.Ease.bounceOut).to({y:100,rotation:720},800,createjs.Ease.linear).call(function(){createjs.Tween.get(o).to({alpha:0},500,createjs.Ease.bounceOut),createjs.Tween.get(s).to({alpha:0},500,createjs.Ease.bounceOut),createjs.Tween.get(c).to({alpha:0},500,createjs.Ease.bounceOut),createjs.Tween.get(a).to({alpha:0},500,createjs.Ease.bounceOut),createjs.Tween.get(e).to({alpha:0},500,createjs.Ease.bounceOut),createjs.Tween.get(i).to({x:300,y:287,scaleX:1,scaleY:1},500,createjs.Ease.backInOut).call(function(){createjs.Tween.get(i).to({y:-900},1e3,createjs.Ease.backInOut).call(t)})}),createjs.Tween.get(r).to({x:CANVAS_WIDTH-100,y:CANVAS_HEIGHT-160},1e3,createjs.Ease.linear)},this._onImagesLoaded=function(){},this._onAllImagesLoaded=function(){this._attachSprites(),s_oMain.preloaderReady()},this._attachSprites=function(){var t=createBitmap(s_oSpriteLibrary.getSprite("bg"));s_oStage.addChild(t),o=createBitmap(s_oSpriteLibrary.getSprite("xin1")),o.y=CANVAS_HEIGHT/2-200+60,o.x=CANVAS_WIDTH/2-127+10,s_oStage.addChild(o),i=createBitmap(s_oSpriteLibrary.getSprite("photo")),i.scaleX=.3,i.scaleY=.25,i.y=520,i.x=CANVAS_WIDTH/2-12,i.regY=287,i.regX=300,s_oStage.addChild(i),s=createBitmap(s_oSpriteLibrary.getSprite("xin2")),s.y=CANVAS_HEIGHT/2-100+60,s.x=CANVAS_WIDTH/2-120+10,s_oStage.addChild(s),r=createBitmap(s_oSpriteLibrary.getSprite("x"));var p=new createjs.Shadow("#ffffff",5,5,10);r.shadow=p,r.y=CANVAS_HEIGHT/2+30,r.x=CANVAS_WIDTH/2,r.regX=29.5,r.regY=28,s_oStage.addChild(r),n=createjs.Tween.get(r,{loop:!0}).to({scaleX:1.5,scaleY:1.5},1e3,createjs.Ease.bounceOut).to({scaleX:1,scaleY:1},1e3,createjs.Ease.bounceIn).call(function(){}),c=createBitmap(s_oSpriteLibrary.getSprite("text")),c.y=CANVAS_HEIGHT/2+100+60,c.x=CANVAS_WIDTH/2-90,s_oStage.addChild(c),e=new createjs.Text("0%","30px STXingkai","#ff0000"),e.x=CANVAS_WIDTH/2,e.y=CANVAS_HEIGHT/2+100,e.textBaseline="alphabetic",e.textAlign="center",s_oStage.addChild(e),a=createBitmap(s_oSpriteLibrary.getSprite("logo")),a.regX=100,a.x=CANVAS_WIDTH/2,a.y=CANVAS_HEIGHT-100,s_oStage.addChild(a)},this.update=function(){},this.refreshLoader=function(a){t=a,e.text=t+"%"},this._init()}function CProgressBar(){function e(){c.fillStyle="#272822",c.fillRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),c.fillStyle="#171814",c.fillRect(25,80,350,25)}function t(){this.widths=0,this.hue=0,this.draw=function(){c.fillStyle="hsla("+this.hue+", 100%, 40%, 1)",c.fillRect(25,80,this.widths,25);var e=c.createLinearGradient(0,0,0,130);e.addColorStop(0,"transparent"),e.addColorStop(1,"rgba(0,0,0,0.5)"),c.fillStyle=e,c.fillRect(25,80,this.widths,25)}}function a(){this.x=23+l.widths,this.y=82,this.vx=.8+1*Math.random(),this.v=5*Math.random(),this.g=1+3*Math.random(),this.down=!1,this.draw=function(){c.fillStyle="hsla("+(l.hue+.3)+", 100%, 40%, 1)";var e=2*Math.random();c.fillRect(this.x,this.y,e,e)}}function i(){if(e(),p++,l.hue+=.8,l.widths+=2,l.widths>350)p>215?(e(),l.hue=0,l.widths=0,p=0,d=[]):(l.hue=126,l.widths=351,l.draw());else{l.draw();for(var t=0;t<o;t+=10)d.push(new a)}r()}function r(){for(var e=0;e<d.length;e++){var t=d[e];t.x-=t.vx,1==t.down?(t.g+=.1,t.y+=t.g):t.g<0?(t.down=!0,t.g+=.1,t.y+=t.g):(t.y-=t.g,t.g-=.1),t.draw()}}function n(){i(),requestAnimFrame(n)}var o=25;window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();var s=s_oCanvas,c=s.getContext("2d"),p=0,d=[],l=new t;n()}function CSpriteLibrary(){var e,t,a,i,r,n;this.init=function(o,s,c){t=0,a=0,i=o,r=s,n=c,e={}},this.addSprite=function(a,i){e.hasOwnProperty(a)||(e[a]={szPath:i,oSprite:new Image},t++)},this.getSprite=function(t){return e.hasOwnProperty(t)?e[t].oSprite:null},this._onSpritesLoaded=function(){r.call(n)},this._onSpriteLoaded=function(){i.call(n),++a==t&&this._onSpritesLoaded()},this.loadSprites=function(){for(var t in e)e[t].oSprite.oSpriteLibrary=this,e[t].oSprite.onload=function(){this.oSpriteLibrary._onSpriteLoaded()},e[t].oSprite.src=e[t].szPath},this.getNumSprites=function(){return t}}function trace(e){console.log(e)}function isIphone(){var e=navigator.userAgent.toLowerCase();return e.indexOf("iphone")!==-1}function getSize(e){var t,a=e.toLowerCase(),i=window.document,r=i.documentElement;if(void 0===window["inner"+e])t=r["client"+e];else if(window["inner"+e]!=r["client"+e]){var n=i.createElement("body");n.id="vpw-test-b",n.style.cssText="overflow:scroll";var o=i.createElement("div");o.id="vpw-test-d",o.style.cssText="position:absolute;top:-1000px",o.innerHTML="<style>@media("+a+":"+r["client"+e]+"px){body#vpw-test-b div#vpw-test-d{"+a+":7px!important}}</style>",n.appendChild(o),r.insertBefore(n,i.head),t=7==o["offset"+e]?r["client"+e]:window["inner"+e],r.removeChild(n)}else t=window["inner"+e];return t}function onOrientationChange(){window.matchMedia("(orientation: portrait)").matches&&sizeHandler(),window.matchMedia("(orientation: landscape)").matches&&sizeHandler()}function getIOSWindowHeight(){var e=document.documentElement.clientWidth/window.innerWidth;return window.innerHeight*e}function getHeightOfIOSToolbars(){var e=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return e>1?e:0}function sizeHandler(){if(window.scrollTo(0,1),$("#canvas")){var e,t=!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g);e=t?getIOSWindowHeight():getSize("Height");var a=getSize("Width"),i=Math.min(e/CANVAS_HEIGHT,a/CANVAS_WIDTH);CANVAS_WIDTH*i,CANVAS_HEIGHT*i}}function createBitmap(e,t,a){var i=new createjs.Bitmap(e),r=new createjs.Shape;return t&&a?r.graphics.beginFill("#fff").drawRect(0,0,t,a):r.graphics.beginFill("#ff0").drawRect(0,0,e.width,e.height),i.hitArea=r,i}function showFail(e){$("#header").text(e),$("#header").fadeIn(),setTimeout(function(){$("#header").fadeOut()},3e3)}function createSprite(e,t,a,i,r,n){if(null!==t)var o=new createjs.Sprite(e,t);else var o=new createjs.Sprite(e);var s=new createjs.Shape;return s.graphics.beginFill("#000000").drawRect(-a,-i,r,n),o.hitArea=s,o}function random(e,t){var a=t-e,i=Math.random();return e+Math.round(i*a)}function randomFloatBetween(e,t,a){return"undefined"==typeof a&&(a=2),parseFloat(Math.min(e+Math.random()*(t-e),t).toFixed(a))}function rotateVector2D(e,t){var a=t.getX()*Math.cos(e)+t.getY()*Math.sin(e),i=t.getX()*-Math.sin(e)+t.getY()*Math.cos(e);
t.set(a,i)}function tweenVectorsOnX(e,t,a){var i=e+a*(t-e);return i}function getRandom(e,t){return Math.random()*(t-e)+e}function shuffle(e){for(var t,a,i=e.length;0!==i;)a=Math.floor(Math.random()*i),i-=1,t=e[i],e[i]=e[a],e[a]=t;return e}function bubbleSort(e){var t;do{t=!1;for(var a=0;a<e.length-1;a++)if(e[a]>e[a+1]){var i=e[a];e[a]=e[a+1],e[a+1]=i,t=!0}}while(t)}function compare(e,t){return e.index>t.index?-1:e.index<t.index?1:0}function easeLinear(e,t,a,i){return a*e/i+t}function easeInQuad(e,t,a,i){return a*(e/=i)*e+t}function easeInSine(e,t,a,i){return-a*Math.cos(e/i*(Math.PI/2))+a+t}function easeInCubic(e,t,a,i){return a*(e/=i)*e*e+t}function getTrajectoryPoint(e,t){var a=new createjs.Point,i=(1-e)*(1-e),r=e*e;return a.x=i*t.start.x+2*(1-e)*e*t.traj.x+r*t.end.x,a.y=i*t.start.y+2*(1-e)*e*t.traj.y+r*t.end.y,a}function formatTime(e){e/=1e3;var t=Math.floor(e/60),a=Math.floor(e-60*t),i="";return i+=t<10?"0"+t+":":t+":",i+=a<10?"0"+a:a}function degreesToRadians(e){return e*Math.PI/180}function checkRectCollision(e,t){var a,i;return a=getBounds(e,.9),i=getBounds(t,.98),calculateIntersection(a,i)}function calculateIntersection(e,t){var a,i,r={},n={};return r.cx=e.x+(r.hw=e.width/2),r.cy=e.y+(r.hh=e.height/2),n.cx=t.x+(n.hw=t.width/2),n.cy=t.y+(n.hh=t.height/2),a=Math.abs(r.cx-n.cx)-(r.hw+n.hw),i=Math.abs(r.cy-n.cy)-(r.hh+n.hh),a<0&&i<0?(a=Math.min(Math.min(e.width,t.width),-a),i=Math.min(Math.min(e.height,t.height),-i),{x:Math.max(e.x,t.x),y:Math.max(e.y,t.y),width:a,height:i,rect1:e,rect2:t}):null}function getBounds(e,t){var a={x:1/0,y:1/0,width:0,height:0};if(e instanceof createjs.Container){a.x2=-(1/0),a.y2=-(1/0);var i,r,n=e.children,o=n.length;for(r=0;r<o;r++)i=getBounds(n[r],1),i.x<a.x&&(a.x=i.x),i.y<a.y&&(a.y=i.y),i.x+i.width>a.x2&&(a.x2=i.x+i.width),i.y+i.height>a.y2&&(a.y2=i.y+i.height);a.x==1/0&&(a.x=0),a.y==1/0&&(a.y=0),a.x2==1/0&&(a.x2=0),a.y2==1/0&&(a.y2=0),a.width=a.x2-a.x,a.height=a.y2-a.y,delete a.x2,delete a.y2}else{var s,c,p,d,l,h={};if(e instanceof createjs.Bitmap)l=e.sourceRect||e.image,h.width=l.width*t,h.height=l.height*t;else if(e instanceof createjs.Sprite)if(e.spriteSheet._frames&&e.spriteSheet._frames[e.currentFrame]&&e.spriteSheet._frames[e.currentFrame].image){var g=e.spriteSheet.getFrame(e.currentFrame);h.width=g.rect.width,h.height=g.rect.height,h.regX=g.regX,h.regY=g.regY}else a.x=e.x||0,a.y=e.y||0;else a.x=e.x||0,a.y=e.y||0;h.regX=h.regX||0,h.width=h.width||0,h.regY=h.regY||0,h.height=h.height||0,a.regX=h.regX,a.regY=h.regY,s=e.localToGlobal(0-h.regX,0-h.regY),c=e.localToGlobal(h.width-h.regX,h.height-h.regY),p=e.localToGlobal(h.width-h.regX,0-h.regY),d=e.localToGlobal(0-h.regX,h.height-h.regY),a.x=Math.min(Math.min(Math.min(s.x,c.x),p.x),d.x),a.y=Math.min(Math.min(Math.min(s.y,c.y),p.y),d.y),a.width=Math.max(Math.max(Math.max(s.x,c.x),p.x),d.x)-a.x,a.height=Math.max(Math.max(Math.max(s.y,c.y),p.y),d.y)-a.y}return a}function NoClickDelay(e){this.element=e,window.Touch&&this.element.addEventListener("touchstart",this,!1)}function shuffle(e){for(var t,a,i=e.length;i>0;)a=Math.floor(Math.random()*i),i--,t=e[i],e[i]=e[a],e[a]=t;return e}var s_iPrevTime=0,s_oStage,s_oMain,s_oSpriteLibrary,s_oSoundtrack,s_oCanvas;!function(e){($.browser=$.browser||{}).mobile=/android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(ad|hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|tablet|treo|up\.(browser|link)|vodafone|wap|webos|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}(navigator.userAgent||navigator.vendor||window.opera),$(window).resize(function(){sizeHandler()}),window.addEventListener("orientationchange",onOrientationChange),NoClickDelay.prototype={handleEvent:function(e){switch(e.type){case"touchstart":this.onTouchStart(e);break;case"touchmove":this.onTouchMove(e);break;case"touchend":this.onTouchEnd(e)}},onTouchStart:function(e){e.preventDefault(),this.moved=!1,this.element.addEventListener("touchmove",this,!1),this.element.addEventListener("touchend",this,!1)},onTouchMove:function(e){this.moved=!0},onTouchEnd:function(e){if(this.element.removeEventListener("touchmove",this,!1),this.element.removeEventListener("touchend",this,!1),!this.moved){var t=document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY);3==t.nodeType&&(t=t.parentNode);var a=document.createEvent("MouseEvents");a.initEvent("click",!0,!0),t.dispatchEvent(a)}}},function(){function e(e){var a="visible",i="hidden",r={focus:a,focusin:a,pageshow:a,blur:i,focusout:i,pagehide:i};e=e||window.event,e.type in r?document.body.className=r[e.type]:(document.body.className=this[t]?"hidden":"visible","hidden"===document.body.className?s_oMain.stopUpdate():s_oMain.startUpdate())}var t="hidden";t in document?document.addEventListener("visibilitychange",e):(t="mozHidden")in document?document.addEventListener("mozvisibilitychange",e):(t="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",e):(t="msHidden")in document?document.addEventListener("msvisibilitychange",e):"onfocusin"in document?document.onfocusin=document.onfocusout=e:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=e}();